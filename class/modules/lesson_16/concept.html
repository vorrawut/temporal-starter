
<!DOCTYPE HTML>
<html lang="en" >
    <head>
        <meta charset="UTF-8">
        <title>Concept Â· Temporal Workflow Bootcamp</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="HonKit 6.0.3">
        <meta name="author" content="Temporal Workflow Bootcamp Team">
        
        
    
    <link rel="stylesheet" href="../../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/@honkit/honkit-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="workshop_16.html" />
    
    
    <link rel="prev" href="../lesson_15/diagram.html" />
    

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">Introduction</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../../">
            
                <a href="../../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../Introduction.html">
            
                <a href="../../Introduction.html">
            
                    
                    Welcome to Temporal Workflows
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../temporal-architecture.html">
            
                <a href="../../temporal-architecture.html">
            
                    
                    Temporal Architecture Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../../intro-diagram.html">
            
                <a href="../../intro-diagram.html">
            
                    
                    Visual Introduction
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Core Modules</li>
        
        
    

    
        
        <li class="header">Lesson 1: Introduction to Temporal</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../lesson_1/concept.html">
            
                <a href="../lesson_1/concept.html">
            
                    
                    Concept
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../lesson_1/workshop_1.html">
            
                <a href="../lesson_1/workshop_1.html">
            
                    
                    Workshop
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Lesson 2: Kotlin + Spring Boot + Temporal Setup</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../lesson_2/concept.html">
            
                <a href="../lesson_2/concept.html">
            
                    
                    Concept
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../lesson_2/workshop_2.html">
            
                <a href="../lesson_2/workshop_2.html">
            
                    
                    Workshop
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Lesson 3: Run Temporal Locally</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../lesson_3/concept.html">
            
                <a href="../lesson_3/concept.html">
            
                    
                    Concept
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="../lesson_3/workshop_3.html">
            
                <a href="../lesson_3/workshop_3.html">
            
                    
                    Workshop
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Lesson 4: HelloWorkflow</li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../lesson_4/concept.html">
            
                <a href="../lesson_4/concept.html">
            
                    
                    Concept
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="../lesson_4/workshop_4.html">
            
                <a href="../lesson_4/workshop_4.html">
            
                    
                    Workshop
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Lesson 5: Adding a Simple Activity</li>
        
        
    
        <li class="chapter " data-level="7.1" data-path="../lesson_5/concept.html">
            
                <a href="../lesson_5/concept.html">
            
                    
                    Concept
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.2" data-path="../lesson_5/workshop_5.html">
            
                <a href="../lesson_5/workshop_5.html">
            
                    
                    Workshop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.3" data-path="../lesson_5/diagram.html">
            
                <a href="../lesson_5/diagram.html">
            
                    
                    Diagram
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Lesson 6: Workflow & Activity Separation</li>
        
        
    
        <li class="chapter " data-level="8.1" data-path="../lesson_6/concept.html">
            
                <a href="../lesson_6/concept.html">
            
                    
                    Concept
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.2" data-path="../lesson_6/workshop_6.html">
            
                <a href="../lesson_6/workshop_6.html">
            
                    
                    Workshop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.3" data-path="../lesson_6/diagram.html">
            
                <a href="../lesson_6/diagram.html">
            
                    
                    Diagram
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.4" data-path="../lesson_6/parameter.html">
            
                <a href="../lesson_6/parameter.html">
            
                    
                    Parameters
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Lesson 7: Workflow Input/Output</li>
        
        
    
        <li class="chapter " data-level="9.1" data-path="../lesson_7/concept.html">
            
                <a href="../lesson_7/concept.html">
            
                    
                    Concept
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.2" data-path="../lesson_7/workshop_7.html">
            
                <a href="../lesson_7/workshop_7.html">
            
                    
                    Workshop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.3" data-path="../lesson_7/diagram.html">
            
                <a href="../lesson_7/diagram.html">
            
                    
                    Diagram
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Lesson 8: Activity Retry + Timeout</li>
        
        
    
        <li class="chapter " data-level="10.1" data-path="../lesson_8/concept.html">
            
                <a href="../lesson_8/concept.html">
            
                    
                    Concept
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.2" data-path="../lesson_8/workshop_8.html">
            
                <a href="../lesson_8/workshop_8.html">
            
                    
                    Workshop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.3" data-path="../lesson_8/diagram.html">
            
                <a href="../lesson_8/diagram.html">
            
                    
                    Diagram
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Lesson 9: Error Handling in Workflows</li>
        
        
    
        <li class="chapter " data-level="11.1" data-path="../lesson_9/concept.html">
            
                <a href="../lesson_9/concept.html">
            
                    
                    Concept
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="11.2" data-path="../lesson_9/workshop_9.html">
            
                <a href="../lesson_9/workshop_9.html">
            
                    
                    Workshop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="11.3" data-path="../lesson_9/diagram.html">
            
                <a href="../lesson_9/diagram.html">
            
                    
                    Diagram
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Lesson 10: Signals</li>
        
        
    
        <li class="chapter " data-level="12.1" data-path="../lesson_10/concept.html">
            
                <a href="../lesson_10/concept.html">
            
                    
                    Concept
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="12.2" data-path="../lesson_10/workshop_10.html">
            
                <a href="../lesson_10/workshop_10.html">
            
                    
                    Workshop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="12.3" data-path="../lesson_10/diagram.html">
            
                <a href="../lesson_10/diagram.html">
            
                    
                    Diagram
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Lesson 11: Queries</li>
        
        
    
        <li class="chapter " data-level="13.1" data-path="../lesson_11/concept.html">
            
                <a href="../lesson_11/concept.html">
            
                    
                    Concept
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="13.2" data-path="../lesson_11/workshop_11.html">
            
                <a href="../lesson_11/workshop_11.html">
            
                    
                    Workshop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="13.3" data-path="../lesson_11/diagram.html">
            
                <a href="../lesson_11/diagram.html">
            
                    
                    Diagram
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Lesson 12: Child Workflows & continueAsNew</li>
        
        
    
        <li class="chapter " data-level="14.1" data-path="../lesson_12/concept.html">
            
                <a href="../lesson_12/concept.html">
            
                    
                    Concept
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="14.2" data-path="../lesson_12/workshop_12.html">
            
                <a href="../lesson_12/workshop_12.html">
            
                    
                    Workshop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="14.3" data-path="../lesson_12/diagram.html">
            
                <a href="../lesson_12/diagram.html">
            
                    
                    Diagram
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Lesson 13: Versioning with Workflow.getVersion()</li>
        
        
    
        <li class="chapter " data-level="15.1" data-path="../lesson_13/concept.html">
            
                <a href="../lesson_13/concept.html">
            
                    
                    Concept
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="15.2" data-path="../lesson_13/workshop_13.html">
            
                <a href="../lesson_13/workshop_13.html">
            
                    
                    Workshop
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Lesson 14: Timers and Cron Workflows</li>
        
        
    
        <li class="chapter " data-level="16.1" data-path="../lesson_14/concept.html">
            
                <a href="../lesson_14/concept.html">
            
                    
                    Concept
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="16.2" data-path="../lesson_14/workshop_14.html">
            
                <a href="../lesson_14/workshop_14.html">
            
                    
                    Workshop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="16.3" data-path="../lesson_14/diagram.html">
            
                <a href="../lesson_14/diagram.html">
            
                    
                    Diagram
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Lesson 15: External Service Integration</li>
        
        
    
        <li class="chapter " data-level="17.1" data-path="../lesson_15/concept.html">
            
                <a href="../lesson_15/concept.html">
            
                    
                    Concept
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="17.2" data-path="../lesson_15/workshop_15.html">
            
                <a href="../lesson_15/workshop_15.html">
            
                    
                    Workshop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="17.3" data-path="../lesson_15/diagram.html">
            
                <a href="../lesson_15/diagram.html">
            
                    
                    Diagram
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Lesson 16: Testing + Production Readiness</li>
        
        
    
        <li class="chapter active" data-level="18.1" data-path="concept.html">
            
                <a href="concept.html">
            
                    
                    Concept
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="18.2" data-path="workshop_16.html">
            
                <a href="workshop_16.html">
            
                    
                    Workshop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="18.3" data-path="diagram.html">
            
                <a href="diagram.html">
            
                    
                    Diagram
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Lesson 17: Deployment</li>
        
        
    
        <li class="chapter " data-level="19.1" data-path="../lesson_17/concept.html">
            
                <a href="../lesson_17/concept.html">
            
                    
                    Concept
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="19.2" data-path="../lesson_17/workshop_17.html">
            
                <a href="../lesson_17/workshop_17.html">
            
                    
                    Workshop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="19.3" data-path="../lesson_17/diagram.html">
            
                <a href="../lesson_17/diagram.html">
            
                    
                    Diagram
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Workshop Guides</li>
        
        
    

    
        
        <li class="header">Workshop Instructions</li>
        
        
    
        <li class="chapter " data-level="21.1" data-path="../../workshop/lesson_2/">
            
                <a href="../../workshop/lesson_2/">
            
                    
                    Lesson 2 Workshop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="21.2" data-path="../../workshop/lesson_3/">
            
                <a href="../../workshop/lesson_3/">
            
                    
                    Lesson 3 Workshop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="21.3" data-path="../../workshop/lesson_4/">
            
                <a href="../../workshop/lesson_4/">
            
                    
                    Lesson 4 Workshop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="21.4" data-path="../../workshop/lesson_5/">
            
                <a href="../../workshop/lesson_5/">
            
                    
                    Lesson 5 Workshop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="21.5" data-path="../../workshop/lesson_6/">
            
                <a href="../../workshop/lesson_6/">
            
                    
                    Lesson 6 Workshop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="21.6" data-path="../../workshop/lesson_7/">
            
                <a href="../../workshop/lesson_7/">
            
                    
                    Lesson 7 Workshop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="21.7" data-path="../../workshop/lesson_8/">
            
                <a href="../../workshop/lesson_8/">
            
                    
                    Lesson 8 Workshop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="21.8" data-path="../../workshop/lesson_9/">
            
                <a href="../../workshop/lesson_9/">
            
                    
                    Lesson 9 Workshop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="21.9" data-path="../../workshop/lesson_10/">
            
                <a href="../../workshop/lesson_10/">
            
                    
                    Lesson 10 Workshop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="21.10" data-path="../../workshop/lesson_15/">
            
                <a href="../../workshop/lesson_15/">
            
                    
                    Lesson 15 Workshop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="21.11" data-path="../../workshop/lesson_16/">
            
                <a href="../../workshop/lesson_16/">
            
                    
                    Lesson 16 Workshop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="21.12" data-path="../../workshop/lesson_17/">
            
                <a href="../../workshop/lesson_17/">
            
                    
                    Lesson 17 Workshop
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Workshop Solutions</li>
        
        
    
        <li class="chapter " data-level="22.1" data-path="../../workshop/answer/lesson_2/">
            
                <a href="../../workshop/answer/lesson_2/">
            
                    
                    Lesson 2 Solution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="22.2" data-path="../../workshop/answer/lesson_3/">
            
                <a href="../../workshop/answer/lesson_3/">
            
                    
                    Lesson 3 Solution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="22.3" data-path="../../workshop/answer/lesson_4/">
            
                <a href="../../workshop/answer/lesson_4/">
            
                    
                    Lesson 4 Solution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="22.4" data-path="../../workshop/answer/lesson_5/">
            
                <a href="../../workshop/answer/lesson_5/">
            
                    
                    Lesson 5 Solution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="22.5" data-path="../../workshop/answer/lesson_6/">
            
                <a href="../../workshop/answer/lesson_6/">
            
                    
                    Lesson 6 Solution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="22.6" data-path="../../workshop/answer/lesson_15/">
            
                <a href="../../workshop/answer/lesson_15/">
            
                    
                    Lesson 15 Solution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="22.7" data-path="../../workshop/answer/lesson_16/">
            
                <a href="../../workshop/answer/lesson_16/">
            
                    
                    Lesson 16 Solution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="22.8" data-path="../../workshop/answer/lesson_17/">
            
                <a href="../../workshop/answer/lesson_17/">
            
                    
                    Lesson 17 Solution
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Additional Resources</li>
        
        
    
        <li class="chapter " data-level="23.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Course README
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            Published with HonKit
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../.." >Concept</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="lesson-16-concepts-testing--production-readiness">Lesson 16 Concepts: Testing + Production Readiness</h1>
<h2 id="objective">Objective</h2>
<p>Master comprehensive testing strategies for Temporal workflows and learn production deployment patterns including worker configuration, scalability, monitoring, and operational best practices. This lesson prepares you to deploy and maintain Temporal workflows in real-world production environments.</p>
<h2 id="key-concepts">Key Concepts</h2>
<h3 id="1-testing-strategies">1. <strong>Testing Strategies</strong></h3>
<h4 id="unit-testing-with-testworkflowrule"><strong>Unit Testing with TestWorkflowRule</strong></h4>
<ul>
<li><strong>Isolated Testing</strong>: Test workflow logic without external dependencies</li>
<li><strong>Deterministic Execution</strong>: TestWorkflowRule provides deterministic time and execution</li>
<li><strong>Mock Activities</strong>: Replace real activities with controllable mock implementations</li>
<li><strong>Fast Feedback</strong>: Unit tests run quickly and provide immediate feedback</li>
</ul>
<h4 id="integration-testing"><strong>Integration Testing</strong></h4>
<ul>
<li><strong>Real Temporal Server</strong>: Test against actual Temporal cluster</li>
<li><strong>External Service Mocking</strong>: Mock external APIs while using real Temporal infrastructure</li>
<li><strong>End-to-End Validation</strong>: Verify complete workflow execution paths</li>
<li><strong>Performance Testing</strong>: Measure workflow execution times and resource usage</li>
</ul>
<h4 id="load-testing"><strong>Load Testing</strong></h4>
<ul>
<li><strong>Concurrent Execution</strong>: Test multiple workflow instances simultaneously</li>
<li><strong>Worker Capacity</strong>: Validate worker scaling under load</li>
<li><strong>Resource Utilization</strong>: Monitor memory, CPU, and network usage</li>
<li><strong>Failure Recovery</strong>: Test system behavior under failure conditions</li>
</ul>
<h3 id="2-production-worker-configuration">2. <strong>Production Worker Configuration</strong></h3>
<h4 id="worker-scaling"><strong>Worker Scaling</strong></h4>
<pre><code class="lang-kotlin">val workerOptions = WorkerOptions.newBuilder()
    .setMaxConcurrentActivityExecutions(10)      // Activities per worker
    .setMaxConcurrentWorkflowExecutions(5)       // Workflows per worker
    .setMaxConcurrentLocalActivityExecutions(10) // Local activities per worker
    .build()
</code></pre>
<h4 id="task-queue-design"><strong>Task Queue Design</strong></h4>
<ul>
<li><strong>Domain Separation</strong>: Separate task queues for different business domains</li>
<li><strong>Priority Handling</strong>: Different queues for high/low priority workflows</li>
<li><strong>Resource Isolation</strong>: Isolate resource-intensive workflows</li>
<li><strong>Geographic Distribution</strong>: Regional task queues for latency optimization</li>
</ul>
<h3 id="3-activity-configuration-patterns">3. <strong>Activity Configuration Patterns</strong></h3>
<h4 id="timeout-strategies"><strong>Timeout Strategies</strong></h4>
<ul>
<li><strong>StartToCloseTimeout</strong>: Maximum time for single activity execution</li>
<li><strong>ScheduleToCloseTimeout</strong>: Total time including queuing and retries</li>
<li><strong>ScheduleToStartTimeout</strong>: Maximum time in queue before execution</li>
<li><strong>HeartbeatTimeout</strong>: For long-running activities with progress reporting</li>
</ul>
<h4 id="retry-policies"><strong>Retry Policies</strong></h4>
<pre><code class="lang-kotlin">RetryOptions.newBuilder()
    .setInitialInterval(Duration.ofSeconds(1))     // First retry delay
    .setMaximumInterval(Duration.ofMinutes(1))     // Maximum retry delay
    .setBackoffCoefficient(2.0)                    // Exponential backoff
    .setMaximumAttempts(5)                         // Total retry attempts
    .setDoNotRetry("NonRetryableException")        // Non-retriable errors
    .build()
</code></pre>
<h3 id="4-error-handling-and-compensation">4. <strong>Error Handling and Compensation</strong></h3>
<h4 id="saga-pattern-implementation"><strong>Saga Pattern Implementation</strong></h4>
<ul>
<li><strong>Compensation Activities</strong>: Reverse operations when failures occur</li>
<li><strong>Transaction Boundaries</strong>: Define clear rollback points</li>
<li><strong>Idempotent Operations</strong>: Ensure activities can be safely retried</li>
<li><strong>Error Classification</strong>: Distinguish between retriable and non-retriable failures</li>
</ul>
<h4 id="circuit-breaker-pattern"><strong>Circuit Breaker Pattern</strong></h4>
<pre><code class="lang-kotlin">// In workflow implementation
if (consecutiveFailures &gt; threshold) {
    Workflow.sleep(circuitBreakerDelay)
    // Implement fallback logic or graceful degradation
}
</code></pre>
<h3 id="5-monitoring-and-observability">5. <strong>Monitoring and Observability</strong></h3>
<h4 id="metrics-collection"><strong>Metrics Collection</strong></h4>
<ul>
<li><strong>Workflow Metrics</strong>: Execution time, success/failure rates</li>
<li><strong>Activity Metrics</strong>: Per-activity performance and error rates</li>
<li><strong>Worker Metrics</strong>: CPU, memory, and task queue utilization</li>
<li><strong>Business Metrics</strong>: Domain-specific KPIs and SLAs</li>
</ul>
<h4 id="logging-best-practices"><strong>Logging Best Practices</strong></h4>
<pre><code class="lang-kotlin">// Structured logging in activities
logger.info("Processing payment", mapOf(
    "orderId" to orderId,
    "amount" to amount,
    "paymentMethod" to paymentMethod.type,
    "correlationId" to correlationId
))
</code></pre>
<h3 id="6-security-considerations">6. <strong>Security Considerations</strong></h3>
<h4 id="credential-management"><strong>Credential Management</strong></h4>
<ul>
<li><strong>Environment Variables</strong>: Store secrets outside application code</li>
<li><strong>Vault Integration</strong>: Use secret management systems</li>
<li><strong>Rotation Policies</strong>: Implement automatic credential rotation</li>
<li><strong>Encryption</strong>: Encrypt sensitive data in workflow history</li>
</ul>
<h4 id="network-security"><strong>Network Security</strong></h4>
<ul>
<li><strong>TLS Encryption</strong>: Secure communication between workers and Temporal</li>
<li><strong>Authentication</strong>: Use proper authentication mechanisms</li>
<li><strong>Authorization</strong>: Implement role-based access controls</li>
<li><strong>Network Isolation</strong>: Deploy workers in secure network segments</li>
</ul>
<h2 id="best-practices">Best Practices</h2>
<h3 id="1-testing-patterns">1. <strong>Testing Patterns</strong></h3>
<h4 id="comprehensive-test-coverage"><strong>Comprehensive Test Coverage</strong></h4>
<pre><code class="lang-kotlin">class WorkflowTest {
    @Test
    fun `test successful order processing`() {
        val request = createValidOrderRequest()
        val result = workflow.processOrder(request)

        assertEquals(OrderStatus.SHIPPED, result.status)
        assertTrue(result.errors.isEmpty())
    }

    @Test
    fun `test validation failure handling`() {
        val request = createInvalidOrderRequest()
        val result = workflow.processOrder(request)

        assertEquals(OrderStatus.FAILED, result.status)
        assertFalse(result.validationResult.isValid)
    }

    @Test
    fun `test compensation logic`() {
        // Test rollback when payment fails after inventory reservation
        val mockPaymentActivity = mockFailingPaymentActivity()
        val result = workflow.processOrder(validRequest)

        verify(inventoryActivity).releaseInventory(any())
    }
}
</code></pre>
<h4 id="mock-activity-design"><strong>Mock Activity Design</strong></h4>
<pre><code class="lang-kotlin">// â Good: Configurable mock behavior
class ConfigurableMockPaymentActivity : PaymentActivity {
    var shouldFail = false
    var failureMessage = "Payment gateway unavailable"

    override fun processPayment(request: PaymentRequest): PaymentResult {
        if (shouldFail) {
            throw RuntimeException(failureMessage)
        }
        return PaymentResult(/* success data */)
    }
}

// â Bad: Hardcoded mock behavior
class HardcodedMockPaymentActivity : PaymentActivity {
    override fun processPayment(request: PaymentRequest): PaymentResult {
        // Always returns the same result
        return PaymentResult(processed = true, transactionId = "MOCK_TXN")
    }
}
</code></pre>
<h3 id="2-production-configuration">2. <strong>Production Configuration</strong></h3>
<h4 id="environment-specific-settings"><strong>Environment-Specific Settings</strong></h4>
<pre><code class="lang-kotlin">@Configuration
class TemporalConfig {

    @Value("\${temporal.service.target}")
    private lateinit var temporalServiceTarget: String

    @Value("\${temporal.namespace}")
    private lateinit var namespace: String

    @Bean
    fun workflowServiceStubs(): WorkflowServiceStubs {
        return WorkflowServiceStubs.newServiceStubs(
            WorkflowServiceStubsOptions.newBuilder()
                .setTarget(temporalServiceTarget)
                .setEnableHttps(true)
                .build()
        )
    }

    @Bean
    fun workflowClient(serviceStubs: WorkflowServiceStubs): WorkflowClient {
        return WorkflowClient.newInstance(serviceStubs, 
            WorkflowClientOptions.newBuilder()
                .setNamespace(namespace)
                .build()
        )
    }
}
</code></pre>
<h4 id="worker-lifecycle-management"><strong>Worker Lifecycle Management</strong></h4>
<pre><code class="lang-kotlin">@Component
class WorkerManager {

    @Autowired
    private lateinit var workflowClient: WorkflowClient

    private val workers = mutableListOf&lt;Worker&gt;()

    @PostConstruct
    fun startWorkers() {
        // Create workers for different task queues
        val orderWorker = createOrderProcessingWorker()
        val notificationWorker = createNotificationWorker()

        workers.addAll(listOf(orderWorker, notificationWorker))
        workers.forEach { it.start() }
    }

    @PreDestroy
    fun stopWorkers() {
        workers.forEach { it.shutdown() }
    }
}
</code></pre>
<h3 id="3-performance-optimization">3. <strong>Performance Optimization</strong></h3>
<h4 id="worker-tuning"><strong>Worker Tuning</strong></h4>
<pre><code class="lang-kotlin">// High-throughput configuration
val highThroughputOptions = WorkerOptions.newBuilder()
    .setMaxConcurrentActivityExecutions(50)
    .setMaxConcurrentWorkflowExecutions(20)
    .setLocalActivityWorkerOnly(false)
    .build()

// Memory-constrained configuration
val memoryOptimizedOptions = WorkerOptions.newBuilder()
    .setMaxConcurrentActivityExecutions(5)
    .setMaxConcurrentWorkflowExecutions(2)
    .setMaxWorkflowThreads(100)
    .build()
</code></pre>
<h4 id="activity-optimization"><strong>Activity Optimization</strong></h4>
<pre><code class="lang-kotlin">// â Good: Efficient batch processing
override fun processBulkNotifications(requests: List&lt;NotificationRequest&gt;): List&lt;NotificationResult&gt; {
    return requests.chunked(100) { batch -&gt;
        // Process in batches to optimize throughput
        externalNotificationService.sendBatch(batch)
    }.flatten()
}

// â Bad: Inefficient individual processing
override fun processNotifications(requests: List&lt;NotificationRequest&gt;): List&lt;NotificationResult&gt; {
    return requests.map { request -&gt;
        // Individual API calls are inefficient
        externalNotificationService.send(request)
    }
}
</code></pre>
<h3 id="4-deployment-strategies">4. <strong>Deployment Strategies</strong></h3>
<h4 id="blue-green-deployment"><strong>Blue-Green Deployment</strong></h4>
<pre><code class="lang-kotlin">// Version-aware worker deployment
@Component
class VersionedWorkerManager {

    fun deployNewVersion(version: String, taskQueue: String) {
        // Start new version workers
        val newWorkers = createWorkersForVersion(version, taskQueue)
        newWorkers.forEach { it.start() }

        // Gradually drain old version workers
        gracefullyShutdownOldWorkers()
    }
}
</code></pre>
<h4 id="canary-deployment"><strong>Canary Deployment</strong></h4>
<pre><code class="lang-kotlin">// Route percentage of traffic to new version
@Service
class WorkflowRouter {

    fun routeWorkflow(request: WorkflowRequest): String {
        return if (shouldRouteToCanary(request)) {
            "canary-task-queue"
        } else {
            "production-task-queue"
        }
    }
}
</code></pre>
<h3 id="5-operational-excellence">5. <strong>Operational Excellence</strong></h3>
<h4 id="health-checks"><strong>Health Checks</strong></h4>
<pre><code class="lang-kotlin">@RestController
class HealthController {

    @Autowired
    private lateinit var workflowClient: WorkflowClient

    @GetMapping("/health/temporal")
    fun temporalHealth(): ResponseEntity&lt;Map&lt;String, Any&gt;&gt; {
        return try {
            workflowClient.workflowService.getSystemInfo()
            ResponseEntity.ok(mapOf("status" to "healthy"))
        } catch (e: Exception) {
            ResponseEntity.status(503)
                .body(mapOf("status" to "unhealthy", "error" to e.message))
        }
    }
}
</code></pre>
<h4 id="alerting-and-monitoring"><strong>Alerting and Monitoring</strong></h4>
<pre><code class="lang-kotlin">// Custom metrics for monitoring
@Component
class WorkflowMetrics {

    private val workflowCounter = Counter.builder("workflows_started_total")
        .description("Total workflows started")
        .tag("workflow_type", "order_processing")
        .register(meterRegistry)

    private val workflowTimer = Timer.builder("workflow_duration_seconds")
        .description("Workflow execution duration")
        .register(meterRegistry)

    fun recordWorkflowStart() {
        workflowCounter.increment()
    }

    fun recordWorkflowCompletion(duration: Duration) {
        workflowTimer.record(duration)
    }
}
</code></pre>
<h3 id="6-common-production-issues">6. <strong>Common Production Issues</strong></h3>
<h4 id="memory-management"><strong>Memory Management</strong></h4>
<ul>
<li><strong>History Size</strong>: Monitor workflow history size and use <code>continueAsNew</code> appropriately</li>
<li><strong>Worker Memory</strong>: Tune JVM heap size based on concurrent executions</li>
<li><strong>Activity Payloads</strong>: Keep activity inputs/outputs reasonably sized</li>
</ul>
<h4 id="performance-bottlenecks"><strong>Performance Bottlenecks</strong></h4>
<ul>
<li><strong>Task Queue Latency</strong>: Monitor task queue lag and worker capacity</li>
<li><strong>Database Connections</strong>: Pool and manage database connections in activities</li>
<li><strong>External Service Latency</strong>: Implement proper timeouts and circuit breakers</li>
</ul>
<h4 id="deployment-challenges"><strong>Deployment Challenges</strong></h4>
<ul>
<li><strong>Version Compatibility</strong>: Ensure backward compatibility during deployments</li>
<li><strong>State Migration</strong>: Handle data model changes carefully</li>
<li><strong>Configuration Management</strong>: Use proper configuration management tools</li>
</ul>
<h4 id="troubleshooting-guide"><strong>Troubleshooting Guide</strong></h4>
<pre><code class="lang-kotlin">// Workflow execution debugging
@QueryMethod
fun getExecutionStatus(): Map&lt;String, Any&gt; {
    return mapOf(
        "currentStep" to currentStep,
        "errors" to errors,
        "executionTime" to executionTimeMillis,
        "lastActivityResult" to lastActivityResult
    )
}
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../lesson_15/diagram.html" class="navigation navigation-prev " aria-label="Previous page: Diagram">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="workshop_16.html" class="navigation navigation-next " aria-label="Next page: Workshop">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Concept","level":"18.1","depth":1,"next":{"title":"Workshop","level":"18.2","depth":1,"path":"class/modules/lesson_16/workshop_16.md","ref":"class/modules/lesson_16/workshop_16.md","articles":[]},"previous":{"title":"Diagram","level":"17.3","depth":1,"path":"class/modules/lesson_15/diagram.md","ref":"class/modules/lesson_15/diagram.md","articles":[]},"dir":"ltr"},"config":{"plugins":["-highlight"],"root":".","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"Temporal Workflow Bootcamp Team","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{"version":"1.0.0","course":"Temporal Workflow Bootcamp"},"title":"Temporal Workflow Bootcamp","language":"en","gitbook":">=3.0.0","description":"Master production-ready distributed systems with Temporal workflows"},"file":{"path":"class/modules/lesson_16/concept.md","mtime":"2025-07-25T08:56:58.950Z","type":"markdown"},"gitbook":{"version":"6.0.3","time":"2025-07-25T08:57:09.229Z"},"basePath":"../../..","book":{"language":""}});
        });
    </script>
</div>

        
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="../../../gitbook/gitbook.js"></script>
    <script src="../../../gitbook/theme.js"></script>
    
        
        <script src="../../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../../gitbook/@honkit/honkit-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

